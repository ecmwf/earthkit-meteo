import numpy as np

# The type of the input data per level is encoded in the test name as three letters with:
#   s: scalar
#   a: array
#
# So, e.g. "s_a_s" means the following input data on a level:
#  - data is scalar
#  - coord is array
#  - target_coord is scalar

# "data,coord,target_coord,mode,expected_data",
cases = {
    "pressure_s_s_s": [
        (
            [1012.0, 1000.0, 990.0],
            [1012.0, 1000.0, 990.0],
            [1022.0, 1012.0, 1009.0, 995.0, 990.0, 987.0],
            "linear",
            [np.nan, 1012.0, 1009, 995, 990.0, np.nan],
        ),
        (
            [1012.0, np.nan, 990.0],
            [1012.0, 1000.0, 990.0],
            [1022.0, 1012.0, 1009.0, 995.0, 990.0, 987.0],
            "linear",
            [np.nan, 1012.0, np.nan, np.nan, np.nan, np.nan],
        ),
        (
            [1012.0, np.nan, 990.0],
            [1012.0, 1000.0, 990.0],
            [1022.0, 1012.0, 1009.0, 995.0, 990.0, 987.0],
            "linear",
            [np.nan, 1012.0, np.nan, np.nan, np.nan, np.nan],
        ),
        (
            [
                990.0,
                1000.0,
                1012.0,
            ],
            [
                990.0,
                1000.0,
                1012.0,
            ],
            [1022.0, 1009.0, 995.0, 987.0],
            "linear",
            [np.nan, 1009, 995, np.nan],
        ),
        (
            [1012.0, 1000.0, 990.0],
            [1012.0, 1000.0, 990.0],
            [1022.0, 1009.5, 1009.0, 1002.0, 1000.0, 995.0, 987.0],
            "log",
            [np.nan, 1009.5117769371, 1009.0133929430, 1002.0099668454, 1000.0, 995.0125628669, np.nan],
        ),
        (
            [1012.0, 1000.0, 990.0],
            [1012.0, 1000.0, 990.0],
            [1022.0, 1009.0, 995.0, 992.0, 987.0],
            "nearest",
            [1012.0, 1012, 1000.0, 990.0, 990.0],
        ),
    ],
    "pressure_a_a_s": [
        (
            [[1020.0, 1010.0, 1000.0], [920.0, 910.0, 900.0], [820, 810.0, 800.0]],
            [[1020.0, 1010.0, 1000.0], [920.0, 910.0, 900.0], [820, 810.0, 800.0]],
            [1030.0, 1018.0, 1005.0, 950.0, 914.0, 905.0, 850.0, 814.0, 805.0, 790.0],
            "linear",
            [
                [np.nan, np.nan, np.nan],
                [1018.0, np.nan, np.nan],
                [1005.0, 1005.0, np.nan],
                [950.0, 950.0, 950.0],
                [914.0, 914.0, 914.0],
                [905.0, 905.0, 905.0],
                [850.0, 850.0, 850.0],
                [np.nan, 814.0, 814.0],
                [np.nan, np.nan, 805.0],
                [np.nan, np.nan, np.nan],
            ],
        ),
    ],
    "pressure_a_s_s": [
        (
            [[200.0, 210.0, 220.0], [100, 110, 120], [0, 10.0, 20.0]],
            [1000.0, 900.0, 800.0],
            [1020.0, 1000.0, 960.0, 900.0, 860.0, 800.0, 750.0],
            "linear",
            [
                [np.nan, np.nan, np.nan],
                [200.0, 210.0, 220.0],
                [160.0, 170.0, 180.0],
                [100.0, 110.0, 120.0],
                [60.0, 70.0, 80.0],
                [0.0, 10.0, 20.0],
                [np.nan, np.nan, np.nan],
            ],
        ),
        (
            [[0, 10.0, 20.0], [100, 110, 120], [200.0, 210.0, 220.0]],
            [
                800.0,
                900.0,
                1000.0,
            ],
            [1020.0, 1000.0, 960.0, 900.0, 860.0, 800.0, 750.0],
            # [1000.0],
            "linear",
            [
                [np.nan, np.nan, np.nan],
                [200.0, 210.0, 220.0],
                [160.0, 170.0, 180.0],
                [100.0, 110.0, 120.0],
                [60.0, 70.0, 80.0],
                [0.0, 10.0, 20.0],
                [np.nan, np.nan, np.nan],
            ],
        ),
    ],
    "pressure_a_s_a": [
        (
            [[200.0, 210.0, 220.0], [100, 110, 120], [0, 10.0, 20.0]],
            [1000.0, 900.0, 800.0],
            [
                [1030.0, 1020.0, 1010.0],
                [1020.0, 1000.0, 1000.0],
                [960.0, 900.0, 900.0],
                [860.0, 800.0, 800.0],
                [750.0, 800.0, 800.0],
                [749.0, 750.0, 700],
            ],
            "linear",
            [
                [np.nan, np.nan, np.nan],
                [np.nan, 210.0, 220.0],
                [160.0, 110.0, 120.0],
                [60.0, 10.0, 20.0],
                [np.nan, 10.0, 20.0],
                [np.nan, np.nan, np.nan],
            ],
        ),
        (
            [[0, 10.0, 20.0], [100, 110, 120], [200.0, 210.0, 220.0]],
            [800.0, 900.0, 1000.0],
            [
                [1030.0, 1020.0, 1010.0],
                [1020.0, 1000.0, 1000.0],
                [960.0, 900.0, 900.0],
                [860.0, 800.0, 800.0],
                [750.0, 800.0, 800.0],
                [749.0, 750.0, 700],
            ],
            "linear",
            [
                [np.nan, np.nan, np.nan],
                [np.nan, 210.0, 220.0],
                [160.0, 110.0, 120.0],
                [60.0, 10.0, 20.0],
                [np.nan, 10.0, 20.0],
                [np.nan, np.nan, np.nan],
            ],
        ),
    ],
    "pressure_a_a_a": [
        (
            [[200.0, 210.0, 220.0], [100, 110, 120], [0, 10.0, 20.0]],
            [[1020.0, 1010.0, 1000.0], [920.0, 910.0, 900.0], [820, 810.0, 800.0]],
            [
                [1030.0, 1020.0, 1010.0],
                [1020.0, 1000.0, 1000.0],
                [960.0, 900.0, 900.0],
                [860.0, 800.0, 800.0],
                [750.0, 810.0, 800.0],
                [749.0, 750.0, 700],
            ],
            "linear",
            [
                [np.nan, np.nan, np.nan],
                [200.0, 200.0, 220.0],
                [140.0, 100.0, 120.0],
                [40.0, np.nan, 20.0],
                [np.nan, 10.0, 20.0],
                [np.nan, np.nan, np.nan],
            ],
        ),
        (
            [[0, 10.0, 20.0], [100, 110, 120], [200.0, 210.0, 220.0]],
            [[820, 810.0, 800.0], [920.0, 910.0, 900.0], [1020.0, 1010.0, 1000.0]],
            [
                [1030.0, 1020.0, 1010.0],
                [1020.0, 1000.0, 1000.0],
                [960.0, 900.0, 900.0],
                [860.0, 800.0, 800.0],
                [750.0, 810.0, 800.0],
                [749.0, 750.0, 700],
            ],
            "linear",
            [
                [np.nan, np.nan, np.nan],
                [200.0, 200.0, 220.0],
                [140.0, 100.0, 120.0],
                [40.0, np.nan, 20.0],
                [np.nan, 10.0, 20.0],
                [np.nan, np.nan, np.nan],
            ],
        ),
    ],
    "height_s_s_s": [
        (
            [-100.0, 1.0, 100],
            [-100.0, 1.0, 100],
            [-200.0, -100.0, 0.0, 1.0, 50.0, 100.0, 150.0],
            "linear",
            [np.nan, -100.0, 0.0, 1.0, 50.0, 100.0, np.nan],
        ),
    ],
    "height_a_a_a": [
        (
            [[200.0, 210.0, 220.0], [100, 110, 120], [0, 10.0, 20.0]],
            [[10.0, 20.0, 100.0], [110.0, 120.0, 200.0], [210.0, 220.0, 300.0]],
            [
                [-100.0, 1.0, 10.0],
                [-100.0, 30.0, 10.0],
                [10.0, 20.0, 100.0],
                [20.0, 30.0, 110.0],
                [120.0, 130.0, 210.0],
                [50.0, 130.0, 150.0],
                [220.0, 130.0, 320.0],
                [220.0, 230.0, 320.0],
            ],
            "linear",
            [
                [np.nan, np.nan, np.nan],
                [np.nan, 200.0, np.nan],
                [200.0, 210.0, 220.0],
                [190.0, 200.0, 210.0],
                [90.0, 100.0, 110.0],
                [160.0, 100.0, 170.0],
                [np.nan, 100.0, np.nan],
                [np.nan, np.nan, np.nan],
            ],
        ),
    ],
}
